---
/**
 * TrailblazersSection Component
 *
 * Displays the 22 Mobility Trailblazers 2025 honorees with interactive features.
 *
 * Features:
 * - Category filtering via tabs (All, Etablierte, Start-ups, Politik)
 * - Expandable evaluation criteria for each trailblazer
 * - Responsive grid layout
 * - LinkedIn profile links
 * - Glassmorphism design effects
 *
 * @component
 * @version 1.1.0
 * @since October 2024
 */

// Import required components and data
import Icons from "./Icons.astro";
import { trailblazers, categoryLabels, categoryColors, type Trailblazer } from "../data/trailblazers";

// Data now imported from src/data/trailblazers.ts for better maintainability
// Removed 400+ lines of hardcoded data
// TO ADD/EDIT TRAILBLAZERS: Edit src/data/trailblazers.ts instead
---

<section class="trailblazers" id="trailblazers">
	<!-- Section divider at top -->
	<div class="section-divider-top">
		<svg
			viewBox="0 0 1200 60"
			xmlns="http://www.w3.org/2000/svg"
			preserveAspectRatio="none"
		>
			<polygon points="0,60 1200,0 1200,0 0,0" fill="#F8F0E3"></polygon>
		</svg>
	</div>

	<div class="container">
		<div class="trailblazers-header">
			<h2 class="trailblazers-title">Mobility Trailblazers 2025</h2>
			<p class="trailblazers-subtitle">
				Die 22 Vision√§re, die unsere Mobilit√§t von morgen gestalten
			</p>
		</div>

		<!-- Category Filter Tabs -->
		<div class="category-tabs" role="tablist" aria-label="Kategorie Filter">
			<button
				class="category-tab active"
				role="tab"
				aria-selected="true"
				aria-controls="trailblazers-panel"
				data-category="all"
			>
				Alle
			</button>
			<button
				class="category-tab"
				role="tab"
				aria-selected="false"
				aria-controls="trailblazers-panel"
				data-category="etablierte"
			>
				Etablierte Unternehmen
			</button>
			<button
				class="category-tab"
				role="tab"
				aria-selected="false"
				aria-controls="trailblazers-panel"
				data-category="startups"
			>
				Start-ups & Katalysatoren
			</button>
			<button
				class="category-tab"
				role="tab"
				aria-selected="false"
				aria-controls="trailblazers-panel"
				data-category="politik"
			>
				Politik & Institutionen
			</button>
		</div>

		<!-- Trailblazers Grid -->
		<div class="trailblazers-grid" id="trailblazers-panel" role="tabpanel">
			{
				trailblazers.map((trailblazer) => (
					<div class="trailblazer-card" data-category={trailblazer.category}>
						<div class="card-header">
							<div class="card-image">
								<img
									src={trailblazer.image}
									alt={`${trailblazer.title ? trailblazer.title + " " : ""}${trailblazer.name}`}
									width="300"
									height="300"
									loading="lazy"
								/>
							</div>
							<div class="category-badge" data-category={trailblazer.category}>
								{categoryLabels[trailblazer.category]}
							</div>
						</div>

						<div class="card-content">
							<h3 class="card-name">
								{trailblazer.title ? trailblazer.title + " " : ""}{trailblazer.name}
							</h3>
							<h4 class="card-organization">{trailblazer.organization}</h4>
							<p class="card-summary">{trailblazer.quickSummary}</p>

							{trailblazer.linkedin && (
								<div class="card-social">
									<a
										href={trailblazer.linkedin}
										target="_blank"
										rel="noopener noreferrer"
										class="social-link"
										aria-label={`LinkedIn Profil von ${trailblazer.name}`}
									>
										<Icons name="linkedin" />
									</a>
								</div>
							)}

							<!-- Expandable Criteria Section -->
							<button
								class="criteria-toggle"
								aria-expanded="false"
								aria-controls={`criteria-${trailblazer.id}`}
							>
								<span>Bewertungskriterien ansehen</span>
								<svg class="toggle-icon" width="20" height="20" viewBox="0 0 24 24">
									<path d="M12 15L7 10H17L12 15Z" fill="currentColor"/>
								</svg>
							</button>

							<div class="criteria-content" id={`criteria-${trailblazer.id}`} aria-hidden="true">
								<div class="criteria-item">
									<h5>üéØ Mut</h5>
									<p>{trailblazer.criteria.courage}</p>
								</div>
								<div class="criteria-item">
									<h5>üí° Innovation</h5>
									<p>{trailblazer.criteria.innovation}</p>
								</div>
								<div class="criteria-item">
									<h5>‚öôÔ∏è Umsetzung</h5>
									<p>{trailblazer.criteria.implementation}</p>
								</div>
								<div class="criteria-item">
									<h5>üìä Relevanz</h5>
									<p>{trailblazer.criteria.relevance}</p>
								</div>
								<div class="criteria-item">
									<h5>üåü Vorbildfunktion</h5>
									<p>{trailblazer.criteria.roleModel}</p>
								</div>
							</div>
						</div>
					</div>
				))
			}
		</div>
	</div>
</section>

<style>
	.trailblazers {
		background: linear-gradient(
			135deg,
			var(--color-primary) 0%,
			#1a5f60 100%
		);
		color: #fff;
		position: relative;
		padding: 4rem 0 5rem;
		overflow: visible;
	}

	.section-divider-top {
		position: absolute;
		top: -1px;
		left: 50%;
		transform: translateX(-50%);
		width: 100%;
		max-width: none;
		overflow: hidden;
		line-height: 0;
		z-index: 2;
	}

	.section-divider-top svg {
		position: relative;
		display: block;
		width: 100%;
		height: 30px;
	}

	.container {
		max-width: 1400px;
		margin: 0 auto;
		padding: 0 1.5rem;
		position: relative;
		z-index: 2;
	}

	.trailblazers-header {
		text-align: center;
		margin-bottom: 3rem;
	}

	.trailblazers-title {
		font-size: 3.2rem;
		font-weight: 700;
		margin-bottom: 1rem;
		color: var(--color-accent);
		text-transform: uppercase;
		letter-spacing: 1px;
	}

	.trailblazers-subtitle {
		font-size: 1.3rem;
		opacity: 0.95;
		max-width: 700px;
		margin: 0 auto;
	}

	/* Category Tabs */
	.category-tabs {
		display: flex;
		justify-content: center;
		gap: 0.5rem;
		margin-bottom: 3rem;
		flex-wrap: wrap;
	}

	.category-tab {
		padding: 0.75rem 1.5rem;
		background: rgb(255, 255, 255, 0.1);
		backdrop-filter: blur(10px);
		border: 2px solid rgb(255, 255, 255, 0.2);
		border-radius: 50px;
		color: #fff;
		font-size: 1rem;
		font-weight: 600;
		cursor: pointer;
		transition: all 0.3s ease;
		white-space: nowrap;
	}

	.category-tab:hover {
		background: rgb(255, 255, 255, 0.2);
		transform: translateY(-2px);
	}

	.category-tab.active {
		background: var(--color-accent);
		border-color: var(--color-accent);
		transform: scale(1.05);
	}

	.category-tab .count {
		opacity: 0.9;
		font-size: 0.9em;
	}

	/* Trailblazers Grid */
	.trailblazers-grid {
		display: grid;
		grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));
		gap: 2.5rem;
		animation: fade-in 0.5s ease;
	}

	@keyframes fade-in {
		from { opacity: 0; }
		to { opacity: 1; }
	}

	/* Card Styles */
	.trailblazer-card {
		background: rgb(255, 255, 255, 0.1);
		backdrop-filter: blur(10px);
		border-radius: 20px;
		padding: 2rem;
		border: 1px solid rgb(255, 255, 255, 0.2);
		transition: all 0.3s ease;
		display: flex;
		flex-direction: column;
	}

	.trailblazer-card:hover {
		transform: translateY(-10px);
		box-shadow: 0 20px 40px rgb(0, 0, 0, 0.3);
		background: rgb(255, 255, 255, 0.15);
	}

	.trailblazer-card[data-hidden="true"] {
		display: none;
	}

	.card-header {
		position: relative;
		margin-bottom: 1.5rem;
	}

	.card-image {
		text-align: center;
	}

	.card-image img {
		width: 200px;
		height: 200px;
		border-radius: 50%;
		object-fit: cover;
		object-position: center;
		border: 4px solid var(--color-accent);
		transition: transform 0.3s ease;
	}

	.trailblazer-card:hover .card-image img {
		transform: scale(1.05);
	}

	.category-badge {
		position: absolute;
		top: 0;
		right: 0;
		padding: 0.5rem 1rem;
		border-radius: 20px;
		font-size: 0.85rem;
		font-weight: 600;
		text-transform: uppercase;
		letter-spacing: 0.5px;
	}

	.category-badge[data-category="etablierte"] {
		background: #003C3D;
		color: #fff;
	}

	.category-badge[data-category="startups"] {
		background: #C1693C;
		color: #fff;
	}

	.category-badge[data-category="politik"] {
		background: #6B46C1;
		color: #fff;
	}

	.card-content {
		flex: 1;
		text-align: center;
		display: flex;
		flex-direction: column;
	}

	.card-name {
		font-size: 1.6rem;
		font-weight: 600;
		margin-bottom: 0.5rem;
		color: var(--color-accent);
	}

	.card-organization {
		font-size: 1.1rem;
		font-weight: 500;
		margin-bottom: 1rem;
		opacity: 0.9;
	}

	.card-summary {
		font-size: 1rem;
		line-height: 1.6;
		margin-bottom: 1.5rem;
		opacity: 0.85;
		flex-grow: 1;
	}

	.card-social {
		display: flex;
		justify-content: center;
		margin-bottom: 1.5rem;
	}

	.social-link {
		display: inline-flex;
		align-items: center;
		justify-content: center;
		width: 40px;
		height: 40px;
		background: var(--color-accent);
		color: #fff;
		border-radius: 50%;
		transition: all 0.3s ease;
		text-decoration: none;
	}

	.social-link:hover {
		background: #fff;
		color: var(--color-accent);
		transform: translateY(-3px);
	}

	.social-link :global(svg) {
		width: 1.2rem;
		height: 1.2rem;
	}

	/* Criteria Toggle */
	.criteria-toggle {
		width: 100%;
		padding: 0.75rem 1rem;
		background: rgb(255, 255, 255, 0.1);
		border: 1px solid rgb(255, 255, 255, 0.2);
		border-radius: 10px;
		color: #fff;
		font-size: 0.95rem;
		font-weight: 600;
		cursor: pointer;
		transition: all 0.3s ease;
		display: flex;
		align-items: center;
		justify-content: space-between;
		margin-top: auto;
	}

	.criteria-toggle:hover {
		background: rgb(255, 255, 255, 0.2);
	}

	.criteria-toggle .toggle-icon {
		transition: transform 0.3s ease;
	}

	.criteria-toggle[aria-expanded="true"] .toggle-icon {
		transform: rotate(180deg);
	}

	/* Criteria Content */
	.criteria-content {
		max-height: 0;
		overflow: hidden;
		opacity: 0;
		transition: all 0.4s ease;
		margin-top: 0;
	}

	.criteria-content[aria-hidden="false"] {
		max-height: 800px;
		opacity: 1;
		margin-top: 1rem;
	}

	.criteria-item {
		background: rgb(0, 0, 0, 0.2);
		border-radius: 10px;
		padding: 1rem;
		margin-bottom: 0.75rem;
		text-align: left;
	}

	.criteria-item:last-child {
		margin-bottom: 0;
	}

	.criteria-item h5 {
		font-size: 1rem;
		font-weight: 600;
		margin-bottom: 0.5rem;
		color: var(--color-accent);
		display: flex;
		align-items: center;
		gap: 0.5rem;
	}

	.criteria-item p {
		font-size: 0.9rem;
		line-height: 1.5;
		opacity: 0.9;
		margin: 0;
	}

	/* Responsive Design */
	@media (min-width: 768px) {
		.section-divider-top svg {
			height: 50px;
		}
	}

	@media (max-width: 1200px) {
		.trailblazers-grid {
			grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
		}
	}

	@media (max-width: 768px) {
		.trailblazers-title {
			font-size: 2.5rem;
		}

		.trailblazers-subtitle {
			font-size: 1.1rem;
		}

		.category-tabs {
			gap: 0.4rem;
		}

		.category-tab {
			padding: 0.6rem 1rem;
			font-size: 0.9rem;
		}

		.trailblazers-grid {
			grid-template-columns: 1fr;
			gap: 2rem;
		}

		.card-image img {
			width: 150px;
			height: 150px;
		}

		.card-name {
			font-size: 1.4rem;
		}
	}
</style>

<script is:inline>
	// Category filtering and criteria toggle functionality
	(function() {
		function initTrailblazers() {
			// Category filtering
			var tabs = document.querySelectorAll('.category-tab');
			var cards = document.querySelectorAll('.trailblazer-card');

			if (!tabs.length || !cards.length) {
				setTimeout(initTrailblazers, 100);
				return;
			}

			// Tab click handler
			function handleTabClick(e) {
				var clickedTab = e.currentTarget;
				var category = clickedTab.getAttribute('data-category');

				// Update active tab
				tabs.forEach(function(tab) {
					tab.classList.remove('active');
					tab.setAttribute('aria-selected', 'false');
				});
				clickedTab.classList.add('active');
				clickedTab.setAttribute('aria-selected', 'true');

				// Filter cards
				cards.forEach(function(card) {
					if (category === 'all' || card.getAttribute('data-category') === category) {
						card.setAttribute('data-hidden', 'false');
						card.style.display = '';
					} else {
						card.setAttribute('data-hidden', 'true');
						card.style.display = 'none';
					}
				});
			}

			// Add tab listeners
			tabs.forEach(function(tab) {
				tab.addEventListener('click', handleTabClick);
			});

			// Criteria toggle functionality
			var criteriaToggles = document.querySelectorAll('.criteria-toggle');

			criteriaToggles.forEach(function(toggle) {
				toggle.addEventListener('click', function(e) {
					e.preventDefault();
					var isExpanded = toggle.getAttribute('aria-expanded') === 'true';
					var targetId = toggle.getAttribute('aria-controls');
					var content = document.getElementById(targetId);

					if (!content) return;

					if (isExpanded) {
						toggle.setAttribute('aria-expanded', 'false');
						content.setAttribute('aria-hidden', 'true');
					} else {
						toggle.setAttribute('aria-expanded', 'true');
						content.setAttribute('aria-hidden', 'false');
					}
				});
			});
		}

		// Initialize when DOM is ready
		if (document.readyState === 'loading') {
			document.addEventListener('DOMContentLoaded', initTrailblazers);
		} else {
			initTrailblazers();
		}
	})();
</script>